<!doctype html>
<html lang="hu">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Titkos K√ºldet√©s</title>
    
    <!-- JAV√çT√ÅS: Permissions Policy meta tag hozz√°adva a helymeghat√°roz√°s enged√©lyez√©s√©hez -->
    <meta http-equiv="Permissions-Policy" content="geolocation=*">
    
    <link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* --- Zoomol√°s √©s G√∂rget√©s Letilt√°sa (A t√°vols√°gmodal miatt) --- */
        html, body.modal-open {
            overflow: hidden;
            height: 100%;
            touch-action: none;
        }

        /* Alapvet≈ë reszet √©s s√∂t√©t h√°tt√©r */
        body {
            margin: 0;
            padding: 0;
            font-family: 'Play', sans-serif;
            color: #e0e0e0; 
            background-color: #1a1a1a; 
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            /* Extra hely az alulra fix√°lt men√º miatt! */
            padding-bottom: 60px; 
        }

        /* Teljes sz√©less√©g≈± K√âP (H√°tt√©r) */
        .full-width-image-container {
            width: 100%;
            height: 100vh; 
            overflow: hidden;
            position: fixed; 
            top: 0;
            left: 0;
            z-index: 0; 
        }

        .full-width-image-container img {
            width: 100%;
            height: 100%;
            object-fit: contain; 
            object-position: center top; 
        }

        /* Tartalom doboz - FIX ALULRA Z√ÅRVA */
        .content-box {
            background-color: rgba(0, 0, 0, 0.7); 
            padding: 40px; 
            margin: 0; 
            border-radius: 10px 10px 0 0; 
            max-width: 800px;
            width: calc(100% - 20px);
            box-shadow: 0 0 25px rgba(138, 43, 226, 0.7);
            border: 3px solid #8a2be2;
            box-sizing: border-box;
            position: fixed; 
            bottom: 50px; 
            left: 50%;
            transform: translateX(-50%); 
            z-index: 10;
            text-align: left;
            min-height: 250px; 
            display: flex; 
            flex-direction: column;
            justify-content: space-between; 
            opacity: 0; 
            transition: opacity 0.5s ease-in-out;
        }

        /* T√∂rt√©net sz√∂vege */
        #story-text-display {
            font-size: 1.3em;
            font-weight: 700;
            line-height: 1.6;
            margin-bottom: 20px;
            white-space: pre-wrap; 
        }
        
        /* Audio gombok... */
        .audio-container {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .audio-button {
            padding: 12px 20px; 
            text-decoration: none;
            color: #1a1a1a;
            background-color: #00FFFF; 
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.4);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .audio-button:hover {
            background-color: #00DDEE;
        }

        /* --- ALS√ì INTERAKCI√ìS S√ÅV (a t√∂rt√©net gombjai) --- */
        .bottom-bar {
            padding-top: 10px;
            border-top: 1px dashed #8a2be2;
            min-height: 48px;
            width: 100%;
        }

        .interaction-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .page-button {
            padding: 12px 20px; 
            text-decoration: none;
            color: #ffffff;
            background-color: #8a2be2;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
            text-transform: uppercase;
            box-shadow: 0 4px 10px rgba(138, 43, 226, 0.4);
        }
        
        .page-button:hover:not(:disabled) {
            background-color: #7b1cd1;
            transform: translateY(-1px);
        }

        .page-button:disabled {
            background-color: #555555;
            cursor: not-allowed;
            box-shadow: none;
            opacity: 0.6;
        }

        /* Jelsz√≥ kont√©ner */
        #password-container {
            display: none;
            flex-direction: column;
            gap: 15px;
            width: 100%;
            text-align: center;
        }

        #password-container.visible {
            display: flex;
        }
        
        #password-input {
            padding: 12px;
            border: 2px solid #8a2be2;
            border-radius: 5px;
            background-color: #2c2c2c;
            color: #00ffff;
            font-size: 1.2em;
            text-align: center;
            font-family: 'Play', sans-serif;
            margin-bottom: 5px; 
        }
        
        .password-interaction {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            width: 100%;
        }

        #check-password-button, #back-button-password {
            padding: 12px 20px; 
            font-size: 1.1em; 
        }
        
        #back-button-password {
            color: #ffffff;
            background-color: #8a2be2; 
        }
        
        #check-password-button {
            color: #ffffff;
            background-color: #00ffff;
            box-shadow: 0 4px 10px rgba(0, 255, 255, 0.4); 
            flex-grow: 1; 
        }
        
        #check-password-button:hover {
            background-color: #00ddee;
            transform: translateY(-1px); 
        }

        #message {
            margin-top: 10px;
            font-weight: 700;
            color: #ff4500;
        }

        /* Avatar k√©p */
        .avatar-image {
            position: absolute;
            top: -50px; 
            left: -10px; 
            width: 70px; 
            height: 70px; 
            border-radius: 50%; 
            object-fit: cover; 
            z-index: 20; 
            display: block; 
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.5); 
            transition: opacity 0.3s ease-in-out; 
        }
        
        /* --- FIX ALS√ì MEN√úSOR --- */
        .fixed-menu-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50px;
            background-color: #1a1a1a;
            border-top: 2px solid #8a2be2;
            z-index: 50; 
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 -4px 15px rgba(138, 43, 226, 0.5);
        }

        .menu-button {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px 10px;
            transition: color 0.3s;
        }

        .menu-button:hover {
            color: #00ffff;
        }

        /* --- GAL√âRIA MODAL ST√çLUSOK --- */
        #galleryModal {
            display: none; 
            position: fixed;
            z-index: 100; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden; 
            background-color: rgba(0, 0, 0, 0.95);
        }

        .gallery-content {
            position: relative;
            margin: auto;
            width: 90%;
            max-width: 900px;
            height: 90%;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gallery-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            display: block;
        }

        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            padding: 16px;
            font-size: 2em;
            color: white;
            cursor: pointer;
            user-select: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .gallery-nav:hover {
            opacity: 1;
        }

        .prev-gallery {
            left: 0;
        }

        .next-gallery {
            right: 0;
        }

        .close-gallery {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            z-index: 110;
        }
        
        .close-gallery:hover,
        .close-gallery:focus {
            color: #00ffff;
        }
        
        /* --- T√°vols√°g Modal (Compass HUD) ST√çLUSOK --- */
        #distanceModal {
            /* JAV√çT√ÅS: display: none a kezdeti rejt√©shez */
            display: none; 
            position: fixed;
            z-index: 200; 
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            /* JAV√çT√ÅS: H√°tt√©rsz√≠n √©s r√°cs elt√°vol√≠tva/√°tl√°tsz√≥v√° t√©ve, hogy az eredeti k√©p l√°tsz√≥djon */
            background-color: transparent; 
            background-image: none;
            
            /* Amikor display: flex-re v√°lt, ezek az elrendez√©si tulajdons√°gok √©rv√©nyes√ºlnek: */
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .distance-content {
            padding: 20px;
            max-width: 90%;
            /* EZ A KONT√âNER MEGTARJA A S√ñT√âT, KIEMELT H√ÅTTERET */
            background-color: rgba(0, 0, 0, 0.85); 
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 255, 255, 0.8);
            border: 2px solid #00ffff;
        }

        #distance-modal-display {
            font-size: 5em;
            font-weight: bold;
            color: #00ff00; /* Neon z√∂ld a t√°vols√°gra */
            margin: 20px 0;
            padding: 10px;
            border-radius: 8px;
            min-width: 200px;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5); 
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        #distance-status {
            color: #aaaaaa;
            font-size: 1.1em;
            margin-bottom: 25px;
            /* √öJ JAV√çT√ÅS: Alap√©rtelmez√©sben rejtett, a hib√°kat a JS teszi l√°that√≥v√° */
            visibility: hidden; 
            height: 0; /* Hogy ne foglaljon helyet a rejtett elem */
            margin-top: -20px; /* Kompenz√°ci√≥ a marg√≥ra */
        }
        
        /* Amikor l√°that√≥, visszakapja a norm√°l st√≠lust (a JS adja hozz√° a .visible oszt√°lyt hiba eset√©n) */
        #distance-status.visible {
            visibility: visible;
            height: auto;
            margin-top: 10px;
        }

        #distance-modal-map-button {
            background-color: transparent;
            border: 2px solid #00ffff; 
            color: #00ffff; 
            padding: 15px 30px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.7);
            transition: all 0.2s ease-in-out;
            text-transform: uppercase;
        }

        #distance-modal-map-button:hover {
            background-color: rgba(0, 255, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 255, 255, 1);
        }

    </style>
</head>
<body>

    <div class="full-width-image-container">
        <!-- Ez a k√©p a f≈ë h√°tt√©rk√©p -->
        <!-- Az eredeti URL-t a JS fogja fel√ºl√≠rni, de a forr√°st m√≥dos√≠tottam a k√≥d alapj√°n -->
        <img id="story-image" src="Img/konyvtar.jpg" alt="Titokzatos jelenet">
    </div>

    <!-- Ez a tartalomdoboz az utols√≥ (jelsz√≥ k√©r√©s) sz√∂vegdoboz -->
    <div class="content-box" id="content-box">
        <img id="avatar-img" class="avatar-image" src="https://github.com/treasurehuntsites/treasurehuntsites.github.io/blob/main/Img/1740218605.png?raw=true" alt="Szerepl≈ë avatar">
        
        <p id="story-text-display"></p>
        
        <div id="audio-container-1" class="audio-container" style="display:none;">
             <button id="play-audio-button-1" class="audio-button">‚ñ∂Ô∏è Lej√°tsz√°s (1)</button>
        </div>
        <div id="audio-container-2" class="audio-container" style="display:none;">
             <button id="play-audio-button-2" class="audio-button">‚ñ∂Ô∏è Lej√°tsz√°s (2)</button>
        </div>


        <div class="bottom-bar">
            <div class="interaction-container" id="interaction-container">
                <button id="prev-page-button" class="page-button" disabled>
                    Vissza
                </button>
                
                <button id="next-page-button" class="page-button">
                    Folytat√°s
                </button>
            </div>

            <div id="password-container">
                <p>Add meg a k√≥dot:</p>
                <input type="password" id="password-input" maxlength="4">
                
                <div class="password-interaction">
                    <button id="back-button-password" class="page-button">
                        Vissza
                    </button>
                    <button id="check-password-button" class="page-button">
                        ELLEN≈êRZ√âS
                    </button>
                </div>
                <p id="message"></p>
            </div>
        </div>
    </div>
    
    <div class="fixed-menu-bar">
        <!-- VISSZAHELYEZVE: T√©rk√©p gomb -->
        <button id="map-button" class="menu-button" title="T√©rk√©p">
            <i class="fa-solid fa-map-location-dot"></i>
        </button>
        
        <button id="image-button" class="menu-button" title="K√©pgal√©ria">
            <i class="fa-solid fa-image"></i>
        </button>
    </div>
    
    <div id="galleryModal">
      <span class="close-gallery" onclick="closeGallery()">√ó</span>
      <div class="gallery-content">
          <a class="gallery-nav prev-gallery" onclick="prevGalleryImage()">‚ùÆ</a>
          <img class="gallery-image" id="galleryImageDisplay" src="">
          <a class="gallery-nav next-gallery" onclick="nextGalleryImage()">‚ùØ</a>
      </div>
    </div>
    
    <!-- √öJ: T√°vols√°g Modal (Compass HUD) -->
    <div id="distanceModal">
        <div class="distance-content">
            <h1>C√âLPONT KERES√âSE</h1>
            
            <div id="distance-modal-display">
                -- M
            </div>
            
            <!-- Az alap√©rtelmezett sz√∂veget a JS fogja fel√ºl√≠rni -->
            <p id="distance-status">Helyzetmeghat√°roz√°s ind√≠t√°sa...</p>
            
            <!-- T√©rk√©p gomb -->
            <a href="https://www.google.com/maps/d/u/0/viewer?mid=1jaaxNriWkeGPzFJC4e--k0CU2QyBFx8&ll=47.453898687406785%2C19.01940665000001&z=13" target="_blank" id="distance-modal-map-button">
                üó∫Ô∏è T√©rk√©p
            </a>
        </div>
    </div>
    <!-- END √öJ: T√°vols√°g Modal -->
    
    <audio id="story-audio-1" src="https://raw.githubusercontent.com/treasurehuntsites/treasurehuntsites.github.io/main/media/Ugynokok1.mp3" preload="auto"></audio>
    <audio id="story-audio-2" src="https://raw.githubusercontent.com/treasurehuntsites/treasurehuntsites.github.io/main/media/Ugynokok2.mp3" preload="auto"></audio>

    <script>
        // --- C√âL ADATOK (√Åtemelve a compass.html-b≈ël) ---
        const COMPASS_LAT = 47.428073;    
        const COMPASS_LON = 19.036570;    
        const COMPASS_RADIUS = 25;       
        const SUCCESS_LINK = "5571.html"; // √Åtir√°ny√≠t√°s innen
        const MAP_URL_FOR_MENU = 'https://www.google.com/maps/d/u/0/viewer?mid=1qTBS42KcRDJRlwSLY1FUDSbAwHxP3wo&ll=47.426209499999985%2C19.038944499999992&z=17';
        // ------------------------------------------------

        // K√âP URL-ek
        const STABLE_IMAGE_URL = "Img/konyvtar.jpg";
        // √öj Avatar URL-ek
        const FRANCOIS_AVATAR_URL = "Img/Francois.png"; 
        const MARTIN_AVATAR_URL = "Img/Martintelefonal2.jpg";
        // √öj H√°tt√©rk√©p
        const LIVING_ROOM_IMAGE_URL = "Img/nappali.jpg"; 
        
        const PUZZLE_IMAGE_URL = "Img/1757454039.jpg"; 

        // GAL√âRIA K√âPEK LIST√ÅJA
        // V√ÅLTOZTAT√ÅS: √úres t√∂mbre cser√©lve, ahogy k√©rted
        const galleryImages = [];
        let currentGalleryIndex = 0;


        // EREDETI T√ñRT√âNETR√âSZEK - FRISS√çTVE A K√âR√âS SZERINT, N√âV N√âLK√úL
        const storyPages = [
            // ----------------------------------------------------------------------------------
            // Jelenet 1: P√°rbesz√©d (H√°tt√©rk√©p: STABLE_IMAGE_URL = "Img/konyvtar.jpg")
            // ----------------------------------------------------------------------------------
            { type: 'text', content: `J√≥ reggelt, Francois vagyok.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `M√©g mindig √∫gy vagy vele, hogy √°tpasszoln√°d valakinek az archiv√°l√°si munk√°idat?`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Nos, tudod a v√©lem√©nyemet arr√≥l a rengeteg r√©gi pap√≠rr√≥l.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Sz√≥val, mit sz√≥ln√°l hozz√°, ha egy id≈ëre mag√°ra hagyn√°d az arch√≠vumot?`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Mi a helyzet, egy √∫jabb unalmas l√°togat√°s a Britt hat√°rn√°l, r√©gi k√∂nyvek ut√°n kutatva?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Ez√∫ttal nem.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `L√°ssuk csak‚Ä¶ 1945, egy frissen felfedezett n√©met bunker a h√°bor√∫ v√©ge t√°j√°r√≥l.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Komolyan mondod?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Hol?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Magyarorsz√°gon.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Mikor indulunk?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Sajnos nem vagyok m√°r olyan fiatal, mint r√©gen.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Egyed√ºl kell menned, de tudok neked seg√≠teni m√©g innen is ha kell.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Szabad vagy ma d√©lut√°n?`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Igen.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Rendben.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Gyere, amint tudsz.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Sz√°m√≠tok r√°d.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Megbesz√©lt√ºk.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: STABLE_IMAGE_URL },
            { type: 'text', content: `Nagyb√°ty√°m h√≠rei kiss√© rejt√©lyesek voltak, de ez csak n√∂velte a k√≠v√°ncsis√°gomat.`, speaker: 'Narrator', avatar: '', image: STABLE_IMAGE_URL },
            { type: 'text', content: `Egy √∫j budapesti bunker ‚Äì ez nem olyan felfedez√©s, ami minden nap megt√∂rt√©nik.`, speaker: 'Narrator', avatar: '', image: STABLE_IMAGE_URL },
            { type: 'text', content: `De mi√©rt ez a siets√©g?`, speaker: 'Narrator', avatar: '', image: STABLE_IMAGE_URL },
            { type: 'text', content: `M√°r majdnem 5 √≥ra.`, speaker: 'Narrator', avatar: '', image: STABLE_IMAGE_URL },
            { type: 'text', content: `Ideje t√∂bbet megtudni.`, speaker: 'Narrator', avatar: '', image: STABLE_IMAGE_URL },
            
            // ----------------------------------------------------------------------------------
            // Jelenet 2: Jelenetv√°lt√°s (H√°tt√©rk√©p: LIVING_ROOM_IMAGE_URL)
            // ----------------------------------------------------------------------------------
            { type: 'text', content: `K√∂sz√∂n√∂m, hogy nem k√©st√©l.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Jelek szerint felgyorsultuak a dolgok.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Hallgatlak.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Csak n√©h√°nyan tudj√°k, amit most el fogok mondani neked.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Hallott√°l m√°r a n√©met Nibiru projektr≈ël?`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A Nibiru?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A 12. bolyg√≥?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Mi k√∂ze van ennek a n√©metekhez?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Igen, a 12. bolyg√≥.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A n√©metek bele√°st√°k magukat mindenf√©le technol√≥gi√°ba, ami seg√≠thetett volna nekik a h√°bor√∫s helyzet√ºkben.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `K√©pzeld el, mit jelentett volna nekik egy m√°sik, magasan fejlett faj technol√≥gi√°ja.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `De a 12. bolyg√≥ csak egy m√≠tosz.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Mit gondolsz?`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `√ân is azt hittem, hogy az, de most m√°r ez nem fontos.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A l√©nyeg az, hogy a n√©metek hittek benne, √©s √©vekig gy≈±jt√∂ttek r√≥la inform√°ci√≥t.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Azt hiszem, nem voltak messze a c√©lt√≥l.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Van egy halv√°ny sejt√©sem, pontosan mit is fedeztek fel, de Nibiru biztosan nem csak egy m√≠tosz.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Igen, folytasd.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Nincs m√°r id≈ëm arra, hogy beavassalak az √∂sszes felfedez√©sembe.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Azonban az l√©tezik, ebben biztos vagyok.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `De t√©rj√ºnk a munk√°hoz.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A felfedez√©sr≈ël sz√≥l√≥ inform√°ci√≥k egy volt koll√©gan≈ëmt≈ël Budapestr≈ël sz√°rmaznak.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Minden el van int√©zve.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            // √öJ SOR BESZ√öR√ÅSA ITT
            { type: 'text', content: `Budapestre m√©sz, √©s tal√°lkozol vele Budafokon a V√°rosh√°za t√©ren.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            // A T√ñBBI SOR ELTOL√ìDIK
            { type: 'text', content: `Ma este?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Az a kontaktod... egy n≈ë?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Pontosan.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Gyorsan kell cselekedn√ºnk.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Az enged√©lyt a felfedez√©si helysz√≠nre val√≥ bel√©p√©shez √©s minden rendelkez√©sre √°ll√≥ inform√°ci√≥t ott fog neked √°tadni.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Ez el√©g siet≈ës!`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Am√∫gy mit gondolsz, mit k√©ne ott tal√°ljak?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `M√©g nem tudom.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Tudod, a h√°bor√∫ v√©g√©n a n√©metek minden √©rt√©ket elrejtettek, hogy a sz√∂vets√©gesek ne foglalhass√°k le.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A r√©g√©szeti kutat√°saik eredm√©nyeit soha nem tal√°lt√°k meg.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Nincs nyom, hol kellene keresni a kincset.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Azonban 1945 √°prilis√°nak v√©g√©n Magyarorsz√°g m√©g n√©metek √°ltal ellen≈ërz√∂tt ter√ºlet volt, az ahol a magyar kapcsolataink is szerepelnek.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Honnan fogom felismerni a n≈ët?`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A V√°rosh√°za t√©r forgalmas ter√ºlet.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A V√°rosh√°za t√©r nappal zs√∫folt.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `De te majd k√©s≈ë √©jszaka √©rkezel, amikor alig l√©zengenek p√°ran.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Am√∫gy meg van r√≥lad egy f√©nyk√©pe.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Minden el≈ë lett k√©sz√≠tve.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A neve √âva.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A rep√ºl≈ëjegy itt van el≈ëtted ebben a bor√≠t√©kban.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Martin, ez most valami nagy dolog.`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Rendben van, felhivlak, amint meg√©rkeztem a helysz√≠nre.`, speaker: 'Martin', avatar: MARTIN_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Sok sikert!`, speaker: 'Francois', avatar: FRANCOIS_AVATAR_URL, image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Valamivel t√∂bb inform√°ci√≥val j√∂ttem el a kast√©lyb√≥l, mint amivel odamentem.`, speaker: 'Narrator', avatar: '', image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `A Nagyb√°ty√°m nagyon magabiztos az eml√≠tett dolgokban.`, speaker: 'Narrator', avatar: '', image: LIVING_ROOM_IMAGE_URL },
            { type: 'text', content: `Induljunk el v√°laszokat keresni Eur√≥pa sz√≠v√©be.`, speaker: 'Narrator', avatar: '', image: LIVING_ROOM_IMAGE_URL } 
        ];

        let currentPartIndex = 0;
        const CORRECT_PASSWORD = "5571";
        
        // DOM elemek
        const contentBox = document.getElementById('content-box');
        const storyDisplay = document.getElementById('story-text-display');
        const nextButton = document.getElementById('next-page-button');
        const prevButton = document.getElementById('prev-page-button');
        const interactionContainer = document.getElementById('interaction-container'); 
        const passwordContainer = document.getElementById('password-container'); 
        const backButtonPassword = document.getElementById('back-button-password'); 

        const passwordInput = document.getElementById('password-input');
        const checkButton = document.getElementById('check-password-button');
        const messageDisplay = document.getElementById('message');
        const storyImage = document.getElementById('story-image'); 
        
        const storyAudio1 = document.getElementById('story-audio-1');
        const playAudioButton1 = document.getElementById('play-audio-button-1');
        const audioContainer1 = document.getElementById('audio-container-1');
        
        const storyAudio2 = document.getElementById('story-audio-2');
        const playAudioButton2 = document.getElementById('play-audio-button-2');
        const audioContainer2 = document.getElementById('audio-container-2');
        
        const avatarImg = document.getElementById('avatar-img');
        
        const imageButton = document.getElementById('image-button');
        const mapButton = document.getElementById('map-button'); // Visszahelyezett t√©rk√©p gomb
        
        // T√°vols√°g Modal DOM elemek √©s √°llapot
        const distanceModal = document.getElementById('distanceModal');
        const distanceDisplay = document.getElementById('distance-modal-display');
        const distanceStatus = document.getElementById('distance-status');
        let watchId = null; // Helyzetfigyel√©s azonos√≠t√≥ja
        
        // GAL√âRIA DOM elemek
        const galleryModal = document.getElementById('galleryModal');
        const galleryImageDisplay = document.getElementById('galleryImageDisplay');


        // --- Seg√©d F√úGGV√âNYEK ---

        function saveProgress() {
            localStorage.setItem('gameProgress', currentPartIndex);
        }

        function loadProgress() {
            const savedIndex = localStorage.getItem('gameProgress');
            if (savedIndex !== null) {
                currentPartIndex = Math.min(parseInt(savedIndex), storyPages.length); 
            } else {
                currentPartIndex = 0;
            }
        }
        
        function stopAllAudio() {
             storyAudio1.pause();
             storyAudio1.currentTime = 0;
             playAudioButton1.innerHTML = "‚ñ∂Ô∏è Lej√°tsz√°s (1)";
             
             storyAudio2.pause();
             storyAudio2.currentTime = 0;
             playAudioButton2.innerHTML = "‚ñ∂Ô∏è Lej√°tsz√°s (2)";
        }

        function toggleAudio(audioElement, buttonElement, buttonText) {
            if (audioElement.paused) {
                stopAllAudio(); 
                audioElement.play().catch(error => {
                    console.error('Autoplay failed, user interaction needed.', error);
                });
                buttonElement.innerHTML = `‚è∏Ô∏è Sz√ºnet (${buttonText})`;
            } else {
                audioElement.pause();
                buttonElement.innerHTML = `‚ñ∂Ô∏è Lej√°tsz√°s (${buttonText})`;
            }
        }
        
        // --- GAL√âRIA FUNKCI√ìK ---
        
        function showGalleryImage(index) {
            // Ellen≈ërizz√ºk, hogy van-e k√©p a gal√©ri√°ban
            if (galleryImages.length === 0) {
                console.warn("A gal√©ria √ºres. Nincs megjelen√≠thet≈ë k√©p.");
                closeGallery();
                // Opcion√°lis: itt lehetne egy √ºzenetet megjelen√≠teni
                return;
            }
            
            currentGalleryIndex = (index + galleryImages.length) % galleryImages.length;
            galleryImageDisplay.src = galleryImages[currentGalleryIndex].url;
            galleryImageDisplay.alt = galleryImages[currentGalleryIndex].title;
        }

        function nextGalleryImage() {
            showGalleryImage(currentGalleryIndex + 1);
        }

        function prevGalleryImage() {
            showGalleryImage(currentGalleryIndex - 1);
        }

        function openGallery() {
            if (galleryImages.length === 0) {
                 // Ha √ºres a gal√©ria, ne nyissuk meg a modalt.
                 console.log("A gal√©ria jelenleg √ºres, a gomb inakt√≠v.");
                 return;
            }
            
            showGalleryImage(0); // Mindig az els≈ë k√©ppel kezd√ºnk
            galleryModal.style.display = "block";
        }

        function closeGallery() {
            galleryModal.style.display = "none";
        }

        // --- T√ÅVOLS√ÅG/GPS FUNKCI√ìK (Jav√≠tott GPS ind√≠t√°s √©s √öjrapr√≥b√°lkoz√°s) ---
        
        function tavolsagotKiszamol(lat1, lon1, lat2, lon2) {
            const R = 6371e3; 
            const phi1 = lat1 * Math.PI / 180;
            const phi2 = lat2 * Math.PI / 180;
            const deltaPhi = (lat2 - lat1) * Math.PI / 180;
            const deltaLambda = (lon2 - lon1) * Math.PI / 180;

            const a = Math.sin(deltaPhi / 2) * Math.sin(deltaPhi / 2) +
                      Math.cos(phi1) * Math.cos(phi2) *
                      Math.sin(deltaLambda / 2) * Math.sin(deltaLambda / 2);
            
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            
            return R * c; 
        }
        
        function restartCompassTracking() {
            console.log("GPS Hiba t√∂rt√©nt, √∫jrapr√≥b√°lkoz√°s 2 m√°sodperc m√∫lva...");
            setTimeout(startCompassTracking, 2000);
        }
        
        // Seg√©df√ºggv√©ny a st√°tusz megjelen√≠t√©s√©hez
        function setDistanceStatus(message, isError = false) {
            distanceStatus.textContent = message;
            // Ha hiba van, vagy ha nincs t√°vols√°g (pl. "-- M"), akkor l√°that√≥v√° tessz√ºk, egy√©bk√©nt rejtj√ºk
            if (isError || message.includes("Hiba") || message.includes("v√°rjon")) {
                distanceStatus.classList.add('visible');
            } else {
                distanceStatus.classList.remove('visible');
            }
        }


        function startCompassTracking() {
            if (!("geolocation" in navigator)) {
                setDistanceStatus("Hiba: A b√∂ng√©sz≈ëje nem t√°mogatja a helymeghat√°roz√°st.", true);
                console.error("Geolocation API not supported.");
                return;
            }
            
            // Ha m√°r fut a figyel√©s, el≈ësz√∂r le√°ll√≠tjuk
            if (watchId) {
                navigator.geolocation.clearWatch(watchId);
                watchId = null;
            }
            
            // Azonnali visszajelz√©s a felhaszn√°l√≥nak
            setDistanceStatus("Helymeghat√°roz√°s ind√≠t√°sa, k√©rj√ºk v√°rjon...", true);
            distanceDisplay.textContent = "-- M"; 

            console.log("Calling watchPosition...");

            watchId = navigator.geolocation.watchPosition(
                (position) => {
                    const latDeg = position.coords.latitude;
                    const lonDeg = position.coords.longitude;
                    
                    console.log(`GPS OK: Lat=${latDeg}, Lon=${lonDeg}, Accuracy=${position.coords.accuracy}`);

                    const tavolsag = tavolsagotKiszamol(latDeg, lonDeg, COMPASS_LAT, COMPASS_LON);
                    
                    // Friss√≠ti a kijelz≈ët
                    distanceDisplay.textContent = `${tavolsag.toFixed(0)} M`; 
                    
                    // Friss√≠tj√ºk a st√°tuszt, de l√°thatatlan marad, ha sikeres a lek√©r√©s.
                    setDistanceStatus(`Pontoss√°g: ¬±${position.coords.accuracy.toFixed(0)} m. Jelenlegi t√°vols√°g:`, false);

                    // Ellen≈ërzi az √°tir√°ny√≠t√°st
                    if (tavolsag <= COMPASS_RADIUS) {
                        setDistanceStatus("C√©l el√©rve! √Åtir√°ny√≠t√°s 5 m√°sodperc m√∫lva...", true);
                        // Le√°ll√≠tja a helyzetfigyel√©st
                        navigator.geolocation.clearWatch(watchId);
                        watchId = null;
                        setTimeout(() => {
                            window.location.href = SUCCESS_LINK;
                        }, 5000);
                        return;
                    }
                },
                
                (error) => {
                    console.error("GPS Error Code:", error.code, "Message:", error.message);
                    
                    // JAV√çT√ÅS: T√∂rli a folyamatos figyel√©st hiba eset√©n
                    if (watchId) {
                        navigator.geolocation.clearWatch(watchId);
                        watchId = null;
                    }
                    
                    if (error.code === error.PERMISSION_DENIED) {
                        setDistanceStatus("Hiba: K√©rj√ºk, enged√©lyezze a helymeghat√°roz√°st (enged√©ly letiltva).", true);
                        distanceDisplay.textContent = "X";
                    } else if (error.code === error.POSITION_UNAVAILABLE) {
                         setDistanceStatus("Hiba: A helyzetadatok nem √©rhet≈ëk el (rossz GPS v√©tel). √öjrapr√≥b√°lkoz√°s...", true);
                         distanceDisplay.textContent = "X";
                         restartCompassTracking(); // √öjrapr√≥b√°lkoz√°s
                    } else if (error.code === error.TIMEOUT) {
                         setDistanceStatus("Hiba: T√∫l sok√°ig tartott a helyzet meghat√°roz√°sa. √öjrapr√≥b√°lkoz√°s...", true);
                         distanceDisplay.textContent = "X";
                         restartCompassTracking(); // √öjrapr√≥b√°lkoz√°s
                    } else {
                        setDistanceStatus("Hiba a helymeghat√°roz√°sban.", true);
                        distanceDisplay.textContent = "X";
                    }
                },
                
                {
                    enableHighAccuracy: true,
                    // Megn√∂velt timeout a GPS jel stabiliz√°l√°s√°ra (15 mp)
                    timeout: 15000, 
                    // Friss poz√≠ci√≥ k√©r√©se
                    maximumAge: 0 
                }
            );
        }

        function showDistanceModal() {
            // FONTOS JAV√çT√ÅS: Elrejti a f≈ë tartalomdobozt (a jelsz√≥k√©r≈ët), hogy ne takarja a k√©pet.
            contentBox.style.display = 'none'; 
            
            document.body.classList.add('modal-open');
            // A display: none a CSS-ben van be√°ll√≠tva, itt √°ll√≠tjuk √°t flex-re
            distanceModal.style.display = 'flex'; 
            
            // Elind√≠tja a GPS k√∂vet√©st a modal megjelen√©sekor
            startCompassTracking(); 
        }
        
        // --- T√ñRT√âNET/INTERAKCI√ì FUNKCI√ìK ---

        function updateButtons() {
            stopAllAudio(); 

            if (currentPartIndex < storyPages.length) {
                // Norm√°l lapoz√≥ m√≥d 
                interactionContainer.style.display = 'flex';
                passwordContainer.classList.remove('visible');
                
                prevButton.disabled = currentPartIndex === 0;
                nextButton.textContent = 'Folytat√°s';
            } else {
                // K√≥d k√©r√©s m√≥d 
                interactionContainer.style.display = 'none';
                passwordContainer.classList.add('visible');
            }
        }

        function updateAvatar(pageIndex) {
            const page = storyPages[pageIndex];
            
            if (page && page.speaker) {
                if (page.speaker === 'Francois' && page.avatar) {
                    avatarImg.src = page.avatar;
                    avatarImg.alt = 'Francois avatar';
                    avatarImg.style.opacity = 1; 
                } else if (page.speaker === 'Martin' && page.avatar) {
                    avatarImg.src = page.avatar;
                    avatarImg.alt = 'Martin avatar';
                    avatarImg.style.opacity = 1; 
                } else if (page.speaker === 'Narrator') {
                    // Narr√°tor eset√©n elrejtj√ºk az avatart
                    avatarImg.style.opacity = 0;
                }
            } else if (pageIndex >= storyPages.length) {
                // K√≥d beviteln√©l
                avatarImg.style.opacity = 0;
            }
        }

        function showStoryPart() {
            messageDisplay.textContent = ''; 
            contentBox.style.opacity = 0;

            setTimeout(() => {
                audioContainer1.style.display = 'none';
                audioContainer2.style.display = 'none';
                storyDisplay.innerHTML = ''; 

                if (currentPartIndex < storyPages.length) {
                    const currentPage = storyPages[currentPartIndex];
                    
                    updateAvatar(currentPartIndex); 
                    
                    if (currentPage.type === 'text' || currentPage.type === 'audio') {
                        // N√©v n√©lk√ºl jelen√≠tj√ºk meg a sz√∂veget, ahogy a felhaszn√°l√≥ k√©rte
                        storyDisplay.innerHTML = currentPage.content;
                        
                        if (currentPage.type === 'audio') {
                            if (currentPage.audioId === 1) {
                                audioContainer1.style.display = 'block';
                            } else if (currentPage.audioId === 2) {
                                audioContainer2.style.display = 'block';
                            }
                        }
                    }
                    
                    storyImage.src = currentPage.image || STABLE_IMAGE_URL; 
                    
                } else {
                    // K√≥d beviteln√©l
                    updateAvatar(currentPartIndex);
                    storyDisplay.innerHTML = 'Add meg a k√≥dot, amit a pap√≠ron tal√°lsz!';
                }

                contentBox.style.opacity = 1;
                updateButtons();
            }, 500);
        }
        
        // --- ESEM√âNYKEZEL≈êK ---
        
        nextButton.addEventListener('click', () => {
            currentPartIndex++;
            saveProgress();
            showStoryPart();
        });

        prevButton.addEventListener('click', () => {
            if (currentPartIndex > 0) {
                currentPartIndex--;
                saveProgress();
                showStoryPart();
            }
        });
        
        backButtonPassword.addEventListener('click', () => {
            currentPartIndex = storyPages.length - 1; 
            saveProgress();
            showStoryPart();
        });

        checkButton.addEventListener('click', () => {
            const enteredPassword = passwordInput.value.trim();

            if (enteredPassword === CORRECT_PASSWORD) {
                messageDisplay.textContent = 'K√≥d elfogadva! Tov√°bb l√©p√©s...';
                messageDisplay.style.color = '#00FF00';
                localStorage.removeItem('gameProgress'); 
                stopAllAudio();
                
                // Modal megjelen√≠t√©se √©s GPS ind√≠t√°sa CSAK A JELSZ√ì ELLEN≈êRZ√âS UT√ÅN
                showDistanceModal();

            } else {
                messageDisplay.textContent = 'Helytelen jelsz√≥! Pr√≥b√°ld √∫jra.';
                messageDisplay.style.color = '#FF4500';
                passwordInput.value = '';
            }
        });

        passwordInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkButton.click(); 
            }
        });
        
        playAudioButton1.addEventListener('click', () => toggleAudio(storyAudio1, playAudioButton1, '1'));
        playAudioButton2.addEventListener('click', () => toggleAudio(storyAudio2, playAudioButton2, '2'));
        
        // K√©pgal√©ria men√º gomb esem√©nykezel≈ëje
        imageButton.addEventListener('click', openGallery);
        
        // √öJ: T√©rk√©p men√º gomb esem√©nykezel≈ëje (visszahelyezve)
        mapButton.addEventListener('click', () => {
            // Megnyitja a t√©rk√©pet egy √∫j lapon, ahogy az eredeti k√≥dban volt
            window.open(MAP_URL_FOR_MENU);
        });
        

        window.onload = () => {
            loadProgress(); 
            showStoryPart();
        };
        
        // Google Forms k√ºld√©se a bet√∂lt√©skor
        const FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLScMxfTwsgk0nyIiuJ1o9mWHbRkyPA9hBI792mABbOzJOVlONA/formResponse";
        fetch(FORM_URL, {
            method: 'POST',
            mode: 'no-cors'
        }).then(() => {
            console.log("L√°togat√°si adat sikeresen elk√ºldve a Google Sheets fel√©.");
        }).catch(error => {
            console.error("Hiba t√∂rt√©nt a l√°togat√°si k√©r√©s k√ºld√©sekor:", error);
        });
        // ---------------------------------------------------------------------

    </script>
</body>
</html>
